# Research Benchmark Report: Text-Processing Workflow

## Experiment Setup
- **Workflow**: Text-Processing (asymmetric parallel fan-out/fan-in)
- **Date**: 2026-02-03 22:01:14
- **Region**: eu-central-1
- **Total Iterations**: 10 per mode
- **Cold Iterations**: 2 per mode
- **Warm Iterations**: 8 per mode

## Workflow Structure
```
              ┌─────────────────────────────────────────────────┐
              │                                                 │
Input ──►[UserMention]──────────────────────────────────────────┤
              │                                                 ├──►[CreatePost]──►[Publish]
              │                                                 │
Input ──►[FindUrl]──►[ShortenUrl]───────────────────────────────┘
              │         (2 steps - SLOWER)
```

---

## 1. Latency Metrics (Primary Research Metrics)

| Metric | CLASSIC | FUTURE_BASED | Improvement |
|--------|---------|--------------|-------------|
| **E2E Mean** | 3069.7ms | 2153.4ms | **29.8%** |
| E2E Median | 2351.0ms | 806.5ms | 65.7% |
| E2E Std Dev | 2872.0ms | 2116.4ms | - |
| E2E Min | 437.0ms | 395.0ms | - |
| E2E Max | 8030.0ms | 5842.0ms | - |
| **E2E P95** | 6997.3ms | 5385.2ms | **23.0%** |
| E2E P99 | 7823.5ms | 5750.7ms | 26.5% |

### Cold vs Warm Start Comparison

| Metric | CLASSIC | FUTURE_BASED | Improvement |
|--------|---------|--------------|-------------|
| **Cold Start E2E** | 4940.0ms | 4370.5ms | **11.5%** |
| Cold Start Std | 1124.3ms | 645.6ms | - |
| **Warm Start E2E** | 2602.1ms | 1599.1ms | **38.5%** |
| Warm Start Std | 3029.0ms | 1985.9ms | - |

### Fan-In Timing (CreatePost Invocation)

| Metric | CLASSIC | FUTURE_BASED | Improvement |
|--------|---------|--------------|-------------|
| CreatePost Delay Mean | 289.6ms | 824.8ms | -184.8% |
| CreatePost Delay Std | 41.6ms | 961.8ms | - |

---

## 2. Memory Metrics

| Metric | CLASSIC | FUTURE_BASED | Overhead |
|--------|---------|--------------|----------|
| Avg Total Memory | 375.5MB | 329.7MB | -12.2% |
| Avg Max Memory | 94.8MB | 94.4MB | - |
| Avg Aggregator Memory | 95.0MB | 94.5MB | -0.5% |
| Memory Efficiency | 73.3% | 73.3% | - |

---

## 3. Cost Metrics

| Metric | CLASSIC | FUTURE_BASED | Savings |
|--------|---------|--------------|---------|
| **Avg Cost/Run** | $0.000003 | $0.000004 | **-41.0%** |
| Total Benchmark Cost | $0.000026 | $0.000037 | - |
| **Cost/1M Invocations** | $2.60 | $3.66 | **$-1.06** |
| Avg Billed Duration | 862.5ms | 1421.4ms | - |

---

## 4. Cold Start Metrics

| Metric | CLASSIC | FUTURE_BASED | Notes |
|--------|---------|--------------|-------|
| Avg Cold Starts/Run | 0.4 | 0.9 | Per workflow execution |
| Avg Init Duration | 1369.3ms | 1905.3ms | Total init time per run |

---

## 5. Key Findings

### Performance Benefits
1. **Warm Start Improvement**: 38.5% faster in Future-Based mode
2. **Cold Start Improvement**: 11.5% faster due to parallel cold start overlap
3. **P95 Latency Improvement**: 23.0% - consistent gains at tail

### Why Future-Based Is Faster
- **Early Aggregator Invocation**: CreatePost starts -535ms earlier on average
- **Parallel Cold Start**: In cold scenarios, CreatePost warms up while ShortenUrl is still executing
- **Async Fan-In**: Aggregator polls for missing inputs rather than waiting for synchronous completion

### Cost Analysis
- **Cost per Million Invocations**: Future-Based saves $-1.06 per 1M invocations
- **Annual Savings at Scale**: At 10M invocations/month, saves ~$-127.73/year

---

## 6. Methodology

### Benchmark Protocol
1. Configure execution mode via Lambda environment variable (`EAGER=true/false`)
2. Force cold starts by updating Lambda configuration (triggers new container)
3. Invoke workflow via parallel Lambda invocations (UserMention + FindUrl)
4. Wait for completion by monitoring Publish CloudWatch logs
5. Parse REPORT logs to extract memory, duration, and init metrics
6. Calculate aggregate statistics with percentiles

### Measured Points
- **E2E Latency**: Client invocation timestamp → Publish END log timestamp
- **CreatePost Delay**: Client invocation → CreatePost START log timestamp
- **Memory**: Extracted from Lambda REPORT "Max Memory Used"
- **Cost**: Calculated from billed duration × memory × AWS pricing

---

*Generated by benchmark_research_metrics.py*
